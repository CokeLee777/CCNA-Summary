# Routing Protocol Metrics

- 라우터는 목적지 네트워크에 도달하기 위해 취할 수 있는 다수의 경로를 받게될 수 있다.
	- 네트워크로 도달할 수 있는 방법이 다양한 경우
	- 거쳐서 갈 수 있는 경로를 가진 이웃 라우터가 여러 개일 때
- 하지만 라우터가 알고 있는 경로들 중 단 하나의 최적의 경로만이 라우팅 표에 입력되어 사용될 것이다.
- 따라서 다양한 내부 게이트웨이 프로토콜(IGP)에는 어떤 경로가 최적의 경로인지를 결정하기 위한 척도가 필요하고, 각 프로토콜은 이를 계산하기 위해 모두 다른 방법을 사용한다.
## Metric

- 라우팅 프로토콜은 각 가능한 경로에 메트릭 값을 할당하는데, 이 값은 **각 경로의 선호도**를 나타낸다.
- **가장 낮은 메트릭 값을 가지는 경로가 선호**된다.
- OSPF에서 메트릭은 '**비용**'으로 불린다.
- 거리 벡터 라우터들은 **알고있는 네트워크와, 그에 도달하기 위한 메트릭 값을 서로에게 통보**한다.
- 링크 상태 라우터들은 **네트워크 영역 내 모든 링크를 서로에게 통보**한다.
- 각 라우터는 그 정보를 사용해 각 목적지에 도달하기 위한 최적의 경로를 구하기 위해 독립적으로 계산을 한다.
	- 예를들어 링크가 다운되어 목적지로 가는 최적의 경로를 잃은 경우 해당 링크는 라우팅 표에서 제거되고, 다음 최적의 경로로 대체가 된다. 두 번째 최적의 메트릭 값을 가지는 경로일 것이다.
	- 이렇게 자가 치료가 가능하다는 점이 동적 라우팅 프로토콜의 큰 장점이다.
	- 네트워크에 변화가 생기면, 이를 반영하기 위해 라우팅 표가 업데이트된다.
## RIP Metric - Hop Count

- RIP는 항상 메트릭으로 홉 카운트를 사용한다.
	- 홉은 한 라우터에서 다음 라우터로의 단계를 의미한다.
	- 따라서 홉 카운트란, 해당 라우터가 목적지 네트워크에 도달하기까지 거쳐야 하는 라우터의 개수를 의미하게 된다.
- RIP에서 기본 최대 홉 카운트는 15개이다.
	- 바꿀수 있는 값이 아니기 때문에 15개 이상의 홉을 거쳐야 한다면 기본적으로 도달할 수 없는 경로인 것으로 표시된다.
	- 따라서 RIP는 보통 작은 환경이나 테스트 환경에서 쓰인다.
- RIP는 홉 카운트를 메트릭으로 사용하기 때문에 홉 카운트가 많은 경로가 더 비용이 적게 들더라도 홉 카운트가 적은 경로를 우선시한다는 단점이 존재한다.
## OSPF Metric - Cost

- OSPF는 인터페이스 대역폭에서 나온 메트릭 값인 '비용'을 기본적으로 사용한다.
- 경로를 조작하고자 하는 경우에는 직접 링크의 비용을 조정할 수도 있다. 일반적으로 OSPF는 항상 최적의 경로를 취할 것이다.
## IS-IS Metric - Cost

- IS-IS 또한 비용을 메트릭 값으로 사용하지만, OSPF와는 다르게 비용이 인터페이스 대역폭으로부터 자동으로 얻어지지 않는다.
	- 모든 링크는 기본적으로 동일한 비용을 가진다.
- 따라서 IS-IS 이용 시 최대 대역폭을 가지는 특정 경로를 취하게끔 하기 위해서는 직접 구성을 해야한다. OSPF 처럼 자동으로 구성되지 않는다.
## EIGRP Metric

- EIGRP는 메트릭 계산을 위해 대역폭과 링크 지연 시간을 사용한다.
	- 부하와 신뢰성 또한 구성될 수 있으나 기본적으로 무시된다.
- OSPF와 마찬가지로 대역폭이 사용되며, 지연 시간 또한 사용이 된다.
- EIGRP 작동 방식은 지연 시간을 측정하기 위해 링크를 조사하는 식이 아니라 **대역폭을 기반**으로 하는 고정 지연 시간을 사용한다.
	- 경로를 조작하고자 하는 경우에는 링크 지연시간을 직접 구성할 수 있다.
## Choosing a Routing Protocol

- 조직 내에 다수의 라우팅 프로토콜이 운영되는 건 좋은 상황이 아니다.
	- 조직들은 **거의 항상 하나의 프로토콜을 표준화**한다.
	- 조직이 합병되었거나 일종의 역사적, 또는 정치적 이유가 있지 않는 경우에나 다수의 프로토콜을 사용하게 된다.
- RIP는 홉 카운트를 사용하고 기본 최대 메트릭 값이 15이다. 따라서 **RIP는 확장성 제한으로 인해 생산 네트워크에서는 일반적으로 사용되지 않는다.**
- EIGRP는 유지 보수가 매우 쉬우며 아주 빠르게 변화를 측정한다. 메트릭 계산을 통해 보통 최적의 경로를 기본 경로로 선택할 것이다.
	- 하지만 이는 보통 **Cisco 라우터에서만 지원된다**는 단점이 있다.
- OSPF 메트릭 값 계산도 **기본적으로 최적의 경로를 선택**한다. OSPF는 모든 제조업체의 라우터에 지원되는 공개 표준 프로토콜이기 때문에 오늘날 가장 흔히 이용되는 IGP이다. 그러나 유지보수에서는 EIGRP보다 더욱 복잡하다.
- 마지막으로 IS-IS 링크는 **직접 구성을 하지 않으면 홉 카운트를 사용해 보통 우리가 원하지 않는 경로를 최적의 경로로 선택한다.** 확장성이 좋기 때문에 대개 서비스 제공자 네트워크 또는 MPLS 네트워크를 가진 대규모 조직에서만 사용된다.
- 이러한 이유로 실제 대부분의 조직에서는 EIGRP 또는 OSPF를 사용한다.
