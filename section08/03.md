# Subnetting Class C Networks and VLSM
## Class C /31 Subnet

Class C의 주소인 200.15.10.0/24 를 예시로 들어보자. 우리는 이 주소를 서브네팅하여 200.15.10.0/31 을 만들었다고 가정한다. 호스트 주소의 1bit는 1이나 0중에 하나가 될 것이다. 그리고 호스트 주소에서 7bit를 빌려서 네트워크 주소로 사용한다. 이렇게 서브넷은 2의 7제곱 = 128개가 된다.

서브넷당 유효한 호스트 주소는 다음과 같을 것이다.

- 200.15.10.0 - 200.15.10.1
- 200.15.10.2 - 200.15.10.3
- ...
- 200.15.10.254 - 200.15.10.255

하지만 /31을 사용하면 호스트에 할당되는 값은 두 개뿐인데 네트워크나 브로드캐스트 주소는 어떻게 될까? /31 서브넷은 IP 주소 지정 기준을 따르지 않는다. 

/31 서브넷은 지점 간 링크로 Cisco 라우터의 지원을 받는다. 지점 간 링크에는 한쪽과 그 반대편만 존재하기 때문에 한쪽에서 시작된 트래픽은 그 반대쪽으로만 향하며, 그 반대도 마찬가지이다. 다른 곳으로 갈 수 없으니 네트워크나 브로드캐스트 주소가 필요가 없는 것이다. 이러한 이유로 Cisco가 이런 예외를 허용한 것이다.
## Class C /30 Subnet

Class C의 주소인 200.15.10.0/24 를 다시 예시로 들어보자. 우리는 이 주소를 서브네팅하여 200.15.10.0/30 을 만들었다고 가정한다. 호스트 주소는 2의 2승 = 4개 - 2개(네트워크 및 브로드캐스트 주소) = 2개가 될 것이다. 그리고 호스트 주소에서 6bit를 빌려서 네트워크 주소로 사용한다. 이렇게 총 64bit가 각기 호스트를 2개씩 가지게 된다.

서브넷당 유효한 호스트 주소는 다음과 같을 것이다.

- 200.15.10.1 - 200.15.10.2(network .0, broadcast .3)
- 200.15.10.5 - 200.15.10.6(network .4, broadcast .7)
- ...
- 200.15.10.253 - 200.15.10.254(network .252, broadcast .255)
### /31 vs /30

- /31과 /30은 두 경우 모두 각 서브넷에 두 개의 호스트를 가질 수 있다.
- /31은 2의 7승 = 128개의 서브넷, /30은 2의 6승 = 64개의 서브넷을 가질 수 있다.
- /31은 주소 공간을 최대한 활용할 때 유용하다.
- 일반적으로 /30이 더 많이 사용된다.
- CCNA 시험에서 /31이나 /30 중 하나를 골라 사용해야 하는 문제가 나온다면 호스트 두 개를 지원하는 서브넷을 찾아야 하는 문제에서 /31 사용이 명시되어 있지 않은 한은 항상 /30을 사용해라.
## Class C /29 Subnet

Class C의 주소인 200.15.10.0/24를 또 다시 예시로 들어보자. 우리는 이 주소를 서브네팅하여 200.15.10.0/29 을 만들었다고 가정한다. 호스트 주소는 2의 3승 = 8개 - 2(네트워크 및 브로드캐스트 주소) = 2개가 될 것이다. 그리고 호스트 주소에서 5bit를 빌려서 네트워크 주소로 사용한다. 이렇게 총 32bit가 각기 호스트를 6개씩 가지게 된다.

서브넷당 유효한 호스트 주소는 다음과 같을 것이다.

- 200.15.10.1 - 200.15.10.6(network .0, broadcast .7)
- 200.15.10.9 - 200.15.10.14(network .8, broadcast .15)
- ...
- 200.15.10.249 - 200.15.10.254(network .248, broadcast .255)
## Other Class C Subnet Masks

- /31, /30, /29 만 보았지만 경계선을 계속 한칸씩 옮기면서 서브네팅이 가능하다.
- /28도 가능하다. 16개의 네트워크당 14개의 호스트를 가진다.
- /27. 8개의 네트워크당 30개의 호스트를 가진다.
- /26. 4개의 네트워크당 62개의 호스트를 가진다.
- /25. 2개의 네트워크당 126개의 호스트를 가진다.
- /24. 1개의 네트워크당 254개의 호스트를 가진다.
## Variable Length Subnet Masks VLSM

초기 라우팅 프로토콜은 고정 길이 서브넷 마스크 FLSM만 지원하며 서브넷은 가능하나, 특정 네트워크의 모든 서브넷 크기가 동일해야 한다는 단점이 있었다. 예를 들어 모든 서브넷이 14개나 30개의 호스트를 수용한다고 할 때, 그 중 한 개의 서브넷이 최대 30개의 호스트를 필요로 하면, 모든 서브넷이 호스트 30개를 수용할 크기가 되어야 한다는 것이다. 호스트가 3개뿐인 서브넷까지 말이다.

현대 라우팅 프로토콜은 가변 길이 서브넷 마스크를 지원하는데, **같은 범위 안이라면 그 안에서 다른 크기의 서브넷이 있을 수 있다**는 뜻이다. 네트워크 한 쪽의 서브넷이 호스트 10개가 있을 때 14개 호스트를 줄 수 있고, 또 다른 서브넷 호스트가 28개라면 거기에 30개의 호스트를 가지는 서브넷 마스크를 줄 수 있다.

VLSM은 같은 네트워크에서 서브넷 길이가 다르다는 뜻으로 **네트워크의 크기를 더욱 정확히 할 수 있다는 점에서 유용**하다. 또한 주소의 낭비도 훨씬 줄일 수 있다.
## Subnetting Considerations

- 네트워크에 서브넷이 필요한 위치의 수
- 각 서브넷에 필요한 호스트의 수
- 각 위치의 IP 주소 지정 요구사항은 무엇인지?(즉, 다른 부서 및 다른 형태의 호스트에는 서로 다른 서브넷이 필요한지의 여부)
	- 예를들어 사무실이 하나 있는데 그 사무실 내에는 영업 부서, 연구 개발 부서, 회계 부서가 포함되어 있다면 가령 회계 부서가 다른 부서들로부터 보호되기를 원할 수 있다. 이런 경우 당연히 별도의 서브넷에 포함을 시킬 것이다.
	- 서브넷이 다르기 때문에 라우터에서 서브넷 사이를 라우팅해야 할 것이고, IP 주소를 기반으로 제 3계층 수준에서 보호하는 것이 더욱 쉽기 때문이다.
- 각 서브넷에 적합한 크기
	- 주소를 낭비하는 것은 별로지만, 확장할 여지도 남겨두는 것이 좋다.
	- 주소를 너무 낭비하지는 말되, 주소가 부족해 나중에 다시 설계해야 할 정도로 너무 작게 만들어도 안된다.
## Subnetting Design Steps

1. 우선 가장 큰 세그먼트를 찾아 적절한 서브넷 크기를 할당한다.
2. 다음으로는 사용 가능한 주소 공간의 시작 부분에 서브넷을 할당한다.
3. 이 과정을 모든 서브넷이 전부 할당될 때까지 반복한다.

실제 배포에서는 확장 가능한 설계가 필요하다. 예를들어 서브넷 중 하나의 크기가 정확히 14개의 호스트용이라고 가정해보자. 몇 주 내로 몇명의 사람들이 부서로 더 합류할 수도 있으니 서브넷 크기를 딱 맞게 지정하면 안될 것이다. 그렇다면 어떻게 할까? 서브넷 크기를 확장 가능하도록 충분히 크게 만들면 된다.

우리는 가장 큰 서브넷에서 가장 작은 서브넷까지 순차적으로 진행할 예정이니깐 30개 호스트가 있는 서브넷을 갖추고, 30개 호스트 서브넷을 하나 더, 그리고 14개 호스트 서브넷을 만드는 것이다. 이렇게 30개 호스트가 있는 예비 서브넷을 가지게 되는 것이다. 더 필요할 것 같다면 30개짜리 서브넷을 두 개뿐만 아니라 세 개, 혹은 네 개를 만들면 된다. 이렇게 되면 나중에 최대 30개의 호스트가 필요한 새 부서가 생기는 경우에도 예비 서브넷을 사용하면 되니깐 가장 큰 서브넷에서 가장 작은 서브넷으로 진행되는 순차적이고 논리적인 구조를 여전히 유지할 수 있을 것이다.

**CCNA 시험에서는 합리적이라고 판단할 지라도 문제가 요구하는 것만 하면 된다.**
### 예시 1

- 엔지니어링 부서들을 위한 최적의 서브넷 마스크를 계산해보자.
- 2개의 부서는 28개의 호스트를 지원할 정도로는 커야한다.

**풀이**

- 200.15.10.0/24 를 할당받았다.
- /27 서브넷 마스크는 30개의 호스트를 지원한다.
- 뉴욕 엔지니어링 부서의 서브넷은 다음과 같이 구성한다.
	- 네트워크 주소: 200.15.10.0/27
	- 브로드캐스트 주소: 200.15.10.31
	- 호스트 주소 범위: 200.15.10.1 ~ 200.15.10.30
- 보스턴 엔지니어링 부서의 서브넷은 다음과 같이 구성한다.
	- 네트워크 주소: 200.15.10.32/27
	- 브로드캐스트 주소: 200.15.10.63
	- 호스트 주소 범위: 200.15.10.33 ~ 200.15.10.62
