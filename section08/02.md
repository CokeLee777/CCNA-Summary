# Subnetting

## Borrowing Host Bits

우리가 Class C 주소인 200.15.10.0/24 를 구매했다고 가정해보자. 서브네팅을 하기 위해, 즉 네트워크를 여러 작은 서브넷으로 나누기 위해 호스트 비트를 일부 빌려서 네트워크 주소 부분에 더해야 한다. 즉, 네트워크 부분과 호스트 부분을 구분하는 경계선을 오른쪽으로 이동시킬 것이다. 즉, 호스트 주소 중 일부를 가져와서 네트워크 주소 부분에게 주는 것이다.

서브네팅을 할 때 경계선은 항상 오른쪽으로 이동한다. 오른쪽으로 갈수록 우리가 갖게 될 서브넷의 수는 많아지고, 각각의 서브넷에 있는 호스트의 수는 적어진다.
### Calculating the Number of Networks

경계선을 **오른쪽으로 이동시켜** 얻을 수 있는 서브넷의 숫자를 계산하기 위해 **2의 '서브넷 비트 수' 제곱**이라는 공식을 사용한다.

예를들어 Class C 네트워크가 /28 서브넷 마스크를 사용한다면 통상적으로 Class C의 서브넷 마스크는 /24 이므로 이를 /28로 바꾸면 4bit를 빌리는 셈이다. 호스트 부분에서 네트워크 부분으로 4bit를 빌려온 것이다. 이렇게 해서 늘어나는 네트워크의 수는 2의 4제곱 = 16개가 된다.

또 다른 예시로 Class B 네트워크가 /28 서브넷 마스크를 사용한다면 통상적으로 Class B의 서브넷 마스크는 /16 이므로 이를 /28로 바꾸면 12bit를 빌리는 셈이다. 호스트 부분에서 네트워크 부분으로 12bit를 빌려온 것이다. 이렇게 해서 늘어나는 네트워크의 수는 2의 12제곱 = 4096개가 된다.

다른 서브넷 상의 호스트들이 서로 통신을 하려면 라우터를 거쳐야 한다. 그래서 우리는 IP주소 지정 및 서브네팅 등을 하는 것이다. 이렇게 네트워크를 여러 논리적 부분들로 나누게 되면 라우터가 모든 경로를 알고있기 때문에 트래픽을 올바른 경로로 전송할 수 있는 것이다.

### Calculating the Number of Hosts

서브네팅으로 감소하는 호스트의 수를 계산하기 위해서는 **2의 '호스트 비트 수' 제곱에서 2를 빼면된다.** 네트워크 주소와 브로드캐스트 주소는 호스트에 할당할 수 없기 때문에 2를 빼는 것이다.

예를들어 Class C 네트워크가 /28 서브넷 마스크를 사용한다면 호스트가 사용할 수 있는 4bit가 남게 된다. 따라서 호스트에 할당할 수 있는 IP주소는 2의 4제곱 - 2 = 14개가 된다.

또 다른 예시로 Class B 네트워크가 /28 서브넷 마스크를 사용한다면 호스트가 사용할 수 있는 4bit가 남게 된다. 따라서 호스트에 할당할 수 있는 IP주소는 2의 4제곱 - 2 = 14개가 된다.

### ip subnet-zero command

우리가 유효한 호스트 숫자를 계산할 때 2를 빼는 것처럼 예전에는 사용 가능한 네트워크의 수를 계산할 때도 2를 뺐었다. 그 이유는 기존의 인터넷 표준에서 전부 0 또는 전부 1인 호스트 비트를 사용할 수 없는 것과 마찬가지로 전부 0 또는 전부 1인 네트워크 주소 역시 사용할 수 없었기 때문이다.

그러나 위 이유에는 실질적인 이유가 없었기 때문에 IP 주소 공간만 낭비를 하였다. 호스트 비트에서는 실제로 네트워크 주소와 브로드캐스트 주소가 사용되니 합리적인 이유가 있지만, 서브넷 숫자와 관련해서는 아무 이유없이 2를 뺐었다.

그래서 Cisco 라우터에서는 꽤 오래 전부터 이를 **비활성화** 하는 기본 명령어 `ip subnet-zero` 가 존재한다. 이 명령은 **기본적으로 실행되기 때문에 Cisco 네트워크에서는 이 두 개의 네트워크 주소가 바로 사용이 가능하다.**
